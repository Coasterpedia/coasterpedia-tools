services:
  coasterpediatools:
    image: ghcr.io/coasterpedia/coasterpedia-tools/tools@${API_IMAGE}
    restart: always
    networks:
      - coasterpedia_web
    environment:
      ConnectionStrings__DefaultConnection: ${DEFAULT_CONNECTION_STRING}
      OAuthConfig__ClientId: ${OAUTH_CLIENT_ID}
      OAuthConfig__ClientSecret: ${OAUTH_CLIENT_SECRET}
    labels:
      - traefik.enable=true
      - traefik.http.routers.tools.rule=Host(`tools.coasterpedia.net`)
      - traefik.http.routers.tools.entrypoints=web,websecure
      - traefik.http.services.tools.loadbalancer.server.port=8080
    volumes:
      - data_protection_keys:/home/app/.aspnet/DataProtection-Keys
networks:
  coasterpedia_web:
    external: true
volumes:
  data_protection_keys: